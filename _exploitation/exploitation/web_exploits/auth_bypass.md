---
layout: default
title: Auth Bypass
parent: Web Exploits
nav_order: 9
---

# Auth Bypass

---

## PHP strcmp Exploit to Bypass Auth

Read the _index.php.bak_

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/potato]                                                         └─$ cat index.php.bak
<html>                                                                                                  <head></head>
<body>

<?php

$pass= "potato"; //note Change this password regularly

if($_GET['login']==="1"){
  if (strcmp($_POST['username'], "admin") == 0  && strcmp($_POST['password'], $pass) == 0) {
    echo "Welcome! </br> Go to the <a href=\"dashboard.php\">dashboard</a>";
    setcookie('pass', $pass, time() + 365*24*3600);
  }else{
    echo "<p>Bad login/password! </br> Return to the <a href=\"index.php\">login page</a> <p>";
  }
  exit();
}
?>


  <form action="index.php?login=1" method="POST">
                <h1>Login</h1>
                <label><b>User:</b></label>
                <input type="text" name="username" required>
                </br>
                <label><b>Password:</b></label>
                <input type="password" name="password" required>
                </br>
                <input type="submit" id='submit' value='Login' >
  </form>
</body>
</html>
```

# Exploitation

---

## Bypass Login Process with Burp

We are provided the source code for the login page.

The login page uses _strcmp_ to compare the username to the string value of _admin_ and the password value to the stored
variable for the _$pass_ value. If both of those values are _True_ then the login process completes successfully.

```bash
strcmp($_POST['username'], "admin") == 0  && strcmp($\_POST['password'], $pass) == 0)
```

We can exploit this string compare (_strcmp_) operation by comparing a NULL value to a string which returns a NULL, which
is the same as a '0'.

This can be done by setting the _password_ value to an array by intercepting the login request in Burp.

![login](../../../../assets/images/ctfs/proving_grounds/potato/login.png)

Intercept the login request and change the password value to an array.

![burp](../../../../assets/images/ctfs/proving_grounds/potato/burp.png)

We get a successful login reponse from the server and enter the admin area.

![success](../../../../assets/images/ctfs/proving_grounds/potato/success.png)
